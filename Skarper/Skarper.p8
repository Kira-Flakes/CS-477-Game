pico-8 cartridge // http://www.pico-8.com
version 38
__lua__
--inits/variables--

function _init()
  init_splash()
end

function init_splash()
  skunk={
    sp=140,
    anim=0,
    x=50,
    y=32
  }

  _update = update_splash
  _draw = draw_splash
end

function init_menu()
  _update = update_menu
  _draw = draw_menu
end

function init_game()
  player={
    sp=1,
    x=15,
    y=94,
    w=8,
    h=8,
    flp=false,
    dx=0,
    dy=0,
    max_dx=2,
    max_dy=3,
    acc=0.5,
    dash=10,
    boost=4,
    anim=0,
    running=false,
    jumping=false,
    falling=false,
    sliding=false,
    landed=false,
    dashing=false
  }
  
  gravity=0.3
  friction=0.85
  
  --simple camera
  cam_x=0
  
  --map limits
  map_start=0
  map_end=384
  
  --set state
  _update = update_game
  _draw = draw_game
end --end init_game
-->8
--update/draw game--
function update_game()
  player_update()
  player_animate()
  
  --simple camera
  cam_x=player.x-64+(player.w/2)
  if cam_x<map_start then
    cam_x=map_start
  end
  if cam_x>map_end-128 then
    cam_x=map_end-128
  end
  camera(cam_x,0)
end  

function draw_game()
  cls()
  map(0,0)
  spr(player.sp,player.x,player.y,1,1,player.flp)
end
-->8
--collisions--

function collide_map(obj,aim,flag)
  --obj = table needs x,y,w,h
  --aim = left,right,up,down
  
  --dimensions of object
  local x=obj.x  local y=obj.y
  local w=obj.w  local h=obj.h
  
  --what positions to check
  local x1=0  local y1=0
  local x2=0  local y2=0
  
  --aim=direction object is moving
  --below are the hitboxes for
  --each respective movement type
  if aim=="left" then
    x1=x-1  y1=y
    x2=x    y2=y+h-1
    
  elseif aim=="right" then
    x1=x+w-1    y1=y
    x2=x+w  y2=y+h-1
    
  elseif aim=="up" then
    x1=x+2    y1=y-1
    x2=x+w-3  y2=y
  
  elseif aim=="down" then
    x1=x+2    y1=y+h
    x2=x+w-3  y2=y+h
  end --endif
  
  --convert pixels to tiles
  x1/=8  y1/=8
  x2/=8  y2/=8
  
  --if any corners of the rectangle
  --are a map tile, return true
  if fget(mget(x1,y1), flag)
  or fget(mget(x1,y2), flag)
  or fget(mget(x2,y1), flag)
  or fget(mget(x2,y2), flag) then
    return true
  else
    return false
  end --endif
end --end collide_map
-->8
--player functions--

function player_update()
  --physics
  player.dy+=gravity
  player.dx*=friction
  
  --controls
  if btn(⬅️) then
    player.dx-=player.acc
    player.running=true
    player.flp=true
  end
  
  if btn(➡️) then
    player.dx+=player.acc
    player.running=true
    player.flp=false
  end
  
  --jump
  if btnp(⬆️)
  and player.landed then
    player.dy-=player.boost
    player.landed=false
  end
  
  --dash right
  if btnp(🅾️)
  and btnp(➡️)
  and player.running
  and player.landed then
    player.max_dx=10
    player.dx+=player.dash
    player.dashing=true
  end
  
  --dash left
  if btnp(🅾️)
  and btnp(⬅️)
  and player.running
  and player.landed then
    player.max_dx=10
    player.dx-=player.dash
    player.dashing=true
  end
  
  
  --stop running
  if player.running
  and not btn(⬅️)
  and not btn(➡️)
  and not player.falling
  and not player.jumping then
    if abs(player.dx)<.2 then
      player.running=false
      player.dx=0
    end
  end
  
  
  --check collision up and down
  if player.dy>0 then
    player.falling=true
    player.landed=false
    player.jumping=false
    
    player.dy=limit_speed(player.dy,player.max_dy)
    
    if collide_map(player,"down",0) then
      player.landed=true
      player.falling=false
      player.dy=0
      player.y-=(player.y+player.h)%8
    end
  elseif player.dy<0 then
    player.jumping=true
    if collide_map(player,"up",1) then
      player.dy=o
    end
  end
  
  --check collision left and right
  if player.dx<0 then
  
    player.dx=limit_speed(player.dx,player.max_dx)
  
    if collide_map(player,"left",1) then
      player.dx=0
    end
  elseif player.dx>0 then
  
    player.dx=limit_speed(player.dx,player.max_dx)
  
    if collide_map(player,"right",1) then
      player.dx=0
    end
  end
  
  player.x+=player.dx
  player.y+=player.dy

  --limit player to map
  if player.x<map_start then
    player.x=map_start
  end
  if player.x>map_end-player.w then
    player.x=map_end-player.w
  end
end --end player_update



function player_animate()
  if player.jumping then
    player.sp=7
  elseif player.falling then
    player.sp=8
  elseif player.running then
    if time() - player.anim>.15 then
      player.sp += 1
      player.anim=time()
      
      if player.sp > 6 then
        player.sp = 3
      end
    end
  else --player idle
    if time()-player.anim>.2 then
      player.sp+=1
      player.anim=time()
      
      if player.sp>2 then
        player.sp=1
      end
    end
  end
end --end player_animate

function limit_speed(num,maximum)
  return mid(-maximum,num,maximum)
end --end limit_speed
-->8
--update/draw menu--

function update_menu()
  if btnp(❎) then
    --start game
    init_game()
  end
end --end update_menu

function draw_menu()
  cls()
  print("press ❎ to start",30,60,8)
end --end draw_menu
-->8
--update/draw splash screen--

--counts number of frames
fcount=0

function update_splash()
  fcount += 1
  if time()>3.5 then
    init_menu()
  end
end


function draw_splash()
 cls()
 logo()
 --print(""..time(),0,0)
end

function logo()
 spr (skunk.sp,skunk.x,skunk.y,4,4)
 if(fcount > 35) then
   print("sumptuous",48,68,13)
 end
 if(fcount > 55) then
  print("skunk",55,75,10)
 end
 
 if(fcount>30) then
   if time()-skunk.anim>.3 then
        skunk.sp+=4
        skunk.anim=time()
      
        if skunk.sp>140 then
          skunk.sp=128
        end
   end
 end
 
end
__gfx__
00000000005000000050000000050000000500000005000000050000000500000005000000000000000000000000000000000000000000000000000000000000
00000000009555000095570000099550000995500009955000099550000995500009955000000000000000000000000000000000000000000000000000000000
00700700009555000095550000099550000995500009955000099550000995500009955000000000000000000000000000000000000000000000000000000000
00077000009999000099990000099990000999900009999000099990000999900009999000000000000000000000000000000000000000000000000000000000
00077000000550000005500000995500000955000044550000045500000955000000559000000000000000000000000000000000000000000000000000000000
00700700009999000099990000009944000099400000999900009990009099000000990900000000000000000000000000000000000000000000000000000000
00000000090990900909909000990400000940000044090000049000000490000000094000000000000000000000000000000000000000000000000000000000
00000000009009000090090000000400000940000000090000049000004900000000009400000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004997000000
000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000049c9000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000066004999066000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000699600550655600
000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006cc654997445600
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000699655499545600
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000699604499055600
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000066004499066000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000050000550005000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000066094997466000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000088294599428000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000078855005588000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000066006600000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000060000600000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000050000500000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66666666577777750000000055555555000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66666666756666670000000055555555000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66666666775666660000000055555555000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
65555556767566660000000055555555000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
65555556766756660000000055555555000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
65555556766675660000000055555555000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
65555556766667560000000055555555000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66666666576666750000000055555555000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000555555550000000000000000000000005555555500000000000000000000000055555555000000000000000000000000555555550000
00000000000000000055066600005500000000000000000000550666000055000000000000000000005506660000550000000000000000000055066600005500
00000000000000000050666000000500000000000000000000506660000005000000000000000000005066600000050000000000000000000050666000000500
00000000000000000506600006666500000000000000000005066000066665000000000000000000050660000666650000000000000000000506600006666500
00000000000000005066600666666650000000000000000050666006666666500000000000000000506660066666665000000000000000005066600666666650
00000000000000005066606666666650000000000000000050666066666666500000000000000000506660666666665000000000000000005066606666666650
00000000000000005666006666000665000000000000000056660066660006650000000000000000566600666600066500000000000000005666006666000665
00000222200000005666006666000065000002222000000056660066660000650000022220000000566600666600006500000222200000005666006666000065
00002dddd2000000566600666005556500002dddd2000000566600666005556500002dddd2000000566600666005556500002dddd20000005666006660055565
0002dddddd20000005660066600505550002dddddd20000005660066600505550002dddddd20000005660066600505550002dddddd2000000566006660050555
0002dddddd20000005666066660500000002dddddd20000005666066660500000002dddddd20000005666066660500000002dddddd2000000566606666050000
000d2dddd2d000000056666666005000000d2dddd2d000000056666666005000000d2dddd2d000000056666666005000000d2dddd2d000000056666666005000
000dd2222dd000000005666666005000000dd2222dd000000005666666005000000dd2222dd000000005666666005000000dd2222dd000000005666666005000
000dddddddd055555555556666600500000dddddddd055555555556666600500000dddddddd055555555556666600500000dddddddd055555555556666600500
000dddddddd566666000055666660500000dddddddd566666000055666660500000dddddddd566666000055666660500000dddddddd566666000055666660500
000dddddddd660000000005666660500000dddddddd660000000005666660500000dddddddd660000000005666660500000dddddddd660000000005666660500
000dddddddd600066666000566660500000dddddddd600066666000566660500000dddddddd600066666000566660500000dddddddd600066666000566660500
000dddddddd606666666660056660500000dddddddd606666666660056660500000dddddddd606666666660056660500000dddddddd606666666660056660500
0002dddddd2d666666666665555550000002dddddd2d666666666665555550000002dddddd2d666666666665555550000002dddddd2d66666666666555555000
00d22222222dd666666666650050000000d22222222dd666666666650050000000d22222222dd666666666650050000000d22222222dd6666666666500500000
0ddd222222ddd66666666650005000000ddd222222ddd66666666650005000000ddd222222ddd66666666650005000000ddd222222ddd6666666665000500000
0ddddddddddd666666666500005000000ddddddddddd666666666500005000000ddddddddddd666666666500005000000ddddddddddd66666666650000500000
00ddddddddd05550666605000050000000ddddddddd05550666605000050000000ddddddddd05550666605000050000000ddddddddd055506666050000500000
00050667707700500000050000500000000506677077005000000500005000000005066aa0aa005000000500005000000005066aa0aa00500000050000500000
0050067777057050000000500050000000500677770570500000005000500000005006a67705a0500000005000500000005006a65a05a0500000005000500000
005066775a55a050000005500050000000506677775570500000055000500000005066a7775570500000055000500000005066a55a55a0500000055000500000
0050660aa05a0055555550500500000000506607705700555555505005000000005066077057005555555050050000000050660aa05a00555555505005000000
00500000555005500000050055000000005000005550055000000500550000000050000055500550000005005500000000500000555005500000050055000000
00055555005055000000050050000000000555550050550000000500500000000005555500505500000005005000000000055555005055000000050050000000
00000000005550000000055550000000000000000055500000000555500000000000000000555000000005555000000000000000005550000000055550000000
__gff__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003010003000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
00000000000000000000000000000000000000000000000000007f0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000007f0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000414141410000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000007f7f7f7f7f7f0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000004141414141410000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000040404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000404043430000000000007f7f7f7f7f7f7f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000007f7f7f40404343430000000000007f414141414141410000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000007f10117f4040434343437f00000000007f00000000007f7f0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000007f2021404043434343437f7f000000007f00000000007f7f0000000040404040400000007f7f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4040404040404040404040404040404040404040404040404040404040404040404040404040404040404040404040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343430000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343430000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
